# ربات تلگرام کافی نت مهدی

این پروژه یک ربات تلگرام برای مدیریت سفارشات کافی نت است که با پایتون و SQLite3 توسعه داده شده است.

## ویژگی‌ها

- ثبت نام کاربران جدید
- سیستم معرفی دوستان و پاداش
- مدیریت موجودی کاربران
- پنل ادمین برای مدیریت ربات
- نمایش آمار و اطلاعات کاربران

## نیازمندی‌ها

- Python 3.8+
- python-telegram-bot
- requests
- python-dotenv

## نصب و راه‌اندازی

1. کلون کردن مخزن:
```bash
git clone https://github.com/yourusername/coffenet-bot.git
cd coffenet-bot
```

2. ایجاد محیط مجازی و نصب وابستگی‌ها:
```bash
python -m venv venv
source venv/bin/activate  # در لینوکس/مک
venv\Scripts\activate  # در ویندوز
pip install -r requirements.txt
```

3. تنظیم فایل محیطی:
```bash
cp env.example .env
```
سپس فایل `.env` را با اطلاعات خود ویرایش کنید.

4. اجرای ربات:
```bash
python main.py
```

## ساختار پروژه

- `bot.py`: فایل اصلی ربات تلگرام
- `database.py`: مدیریت پایگاه داده SQLite3
- `config.py`: تنظیمات و متغیرهای محیطی
- `main.py`: فایل اصلی برای اجرای ربات
- `show_users.py`: اسکریپت برای نمایش کاربران ثبت شده

## نمایش کاربران

برای مشاهده لیست کاربران ثبت شده در ربات، می‌توانید از دستور زیر استفاده کنید:

```bash
python show_users.py
```

این دستور اطلاعات کامل کاربران شامل شناسه، نام کاربری، شماره تلفن، موجودی، تعداد دعوت‌ها و تاریخ ثبت نام را نمایش می‌دهد.

## پایگاه داده

اطلاعات کاربران و معرفی‌ها در فایل `coffenet.db` ذخیره می‌شود. این فایل به صورت خودکار در اولین اجرای ربات ایجاد می‌شود و در اجراهای بعدی حفظ می‌شود.

## ساختار جداول پایگاه داده

### جدول users
- `user_id`: شناسه کاربر (کلید اصلی)
- `phone_number`: شماره تلفن کاربر
- `balance`: موجودی کاربر
- `username`: نام کاربری در تلگرام
- `created_at`: زمان ثبت نام

### جدول referrals
- `id`: شناسه یکتا (کلید اصلی)
- `inviter_user_id`: شناسه کاربر دعوت‌کننده
- `invitee_user_id`: شناسه کاربر دعوت‌شده
- `inviter_cart_amount`: مبلغ پاداش دعوت‌کننده
- `invitee_cart_amount`: مبلغ پاداش دعوت‌شده
- `referral_date`: تاریخ دعوت 